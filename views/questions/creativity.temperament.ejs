<%- include('../partials/header.ejs', { loggedIn }) %>

<div class="container">
  <div class="display-4">Creativity Temperament Assessment</div>
  <p>
    Please read each statement given below and write in the right margin the
    appropriate number to indicate your opinion on each statement. Since this is
    a feedback instrument, be as truthful as you can.
  </p>

  <form action="/creativity/CT/submit" method="POST" name="myForm">
    <% questions.map(question => { %>
    <div class="shadow-sm rounded p-2 my-4 bg-light">
      <!-- Question begins -->
      <div class="p mb-2"><%= question.statement %></div>

      <% options.map((option, index) => { %>
      <div class="form-check me-2">
        <input
          type="radio"
          class="form-check-input"
          name="<%= question._id %>"
          id="<%= question._id %>_<%= index+1 %>"
          value="<%= index+1 %>"
        />
        <label
          for="<%= question._id %>_<%= index+1 %>"
          class="form-check-label"
        >
          <%= option %>
        </label>
      </div>
      <% }) %>

      <!-- Question ends -->
    </div>
    <% }) %>

    <input
      type="submit"
      class="btn btn-primary"
      value="Submit"
      onclick="handleSubmit();"
    />
  </form>
</div>

<script>
  let inputID = null;
</script>
<% for(const user_answer of user_answers) { %>
<script>
  inputID = "<%= user_answer.question_id %>_<%= user_answer.value %>";
  console.log(inputID);
  document.getElementById(inputID).checked = true;
</script>
<% } %>

<script>
  function handleSubmit() {
    if (confirm("Are you sure you want to submit the assessment?")) {
      document.myForm.submit();
    }
  }

  document.myForm.addEventListener("submit", function (event) {
    event.preventDefault();
  });
</script>

<%- include('../partials/footer.ejs') %>
