<%- include('../partials/header', { loggedIn }) %>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.3/FileSaver.min.js"></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/javascript-canvas-to-blob/3.28.0/js/canvas-to-blob.js"
  integrity="sha512-QinObFNs7mVBtipyw8BEERLHKQ1P2n5Wbxd8Kt+G9ST/lp99qZKlJUUsNSZYSPf/yGL7eNN0UCcDaMiZjXMtGg=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer"
></script>

<div class="container">
  <div class="display-4">NEST Report</div>
  <p><strong>Test Date: </strong><%= userScore.date %></p>

  <div class="my-4">
    <img
      src="<%= user.img_url %>"
      alt="profile image"
      class="img-fluid img-thumbnail"
      width="128"
    />
  </div>

  <div class="row">
    <div class="col-md-6">
      <div class="h4">Personal Information</div>
      <p><strong>Name: </strong><%= user.name %></p>
      <p><strong>Email: </strong><%= user.email %></p>
      <p>
        <strong>Location: </strong><%= user.address.city %>, <%=
        user.address.state %>
      </p>
      <p>
        <strong>Date of Birth: </strong><%= user.dob.day %>-<%= user.dob.month
        %>-<%= user.dob.year %>
      </p>
    </div>

    <div class="col-md-6">
      <h4>Educational Qualifications</h4>
      <table class="table table-hover">
        <tr>
          <td>Grade 10</td>
          <td><%= user.qualifications.grade10.institution %></td>
          <td><%= user.qualifications.grade10.subject %></td>
        </tr>
        <tr>
          <td>Grade 12</td>
          <td><%= user.qualifications.grade12.institution %></td>
          <td><%= user.qualifications.grade12.subject %></td>
        </tr>
        <tr>
          <td>Bachelors</td>
          <td><%= user.qualifications.bachelors.institution %></td>
          <td><%= user.qualifications.bachelors.subject %></td>
        </tr>
        <tr>
          <td>Masters</td>
          <td><%= user.qualifications.masters.institution %></td>
          <td><%= user.qualifications.masters.subject %></td>
        </tr>
        <tr>
          <td>Other</td>
          <td><%= user.qualifications.other.institution %></td>
          <td><%= user.qualifications.other.subject %></td>
        </tr>
      </table>
    </div>
  </div>

  <hr />

  <p class="lead">
    Thank you for taking Aspire’s National Employability Skills Test (NEST™).
    Please review each score for detailed insight with respect to specific areas
    of strength and development for enhancing your employability and a better
    potential job fit
  </p>

  <div class="row justify-content-center">
    <div class="col-6">
      <canvas id="<%= userScore._id %>" class="border border-2 p-4"></canvas>
      <%- include('../profile/scripts/createScoreChart.ejs', { userScore,
      getChartData, scoreIndex: 0 }) %>
    </div>
  </div>
  <button class="btn btn-primary" id="save_0">Save as Image</button>
  <hr />

  <table class="table table-hover">
    <tr>
      <th>Category</th>
      <th>Score</th>
      <th>Description</th>
      <th>Profile</th>
    </tr>

    <% user_feedbacks.map(row => { %>

    <tr>
      <td><%= row.module_name %></td>
      <td><%= row.module_score %></td>
      <td><%= row.module_feedback.description %></td>
      <td><%= row.module_feedback.feedback %></td>
    </tr>

    <% }) %>
  </table>
</div>

<%- include('../partials/footer', { loggedIn }) %>
